!function(e){function t(t){for(var a,n,o=t[0],l=t[1],d=t[2],h=0,p=[];h<o.length;h++)n=o[h],Object.prototype.hasOwnProperty.call(i,n)&&i[n]&&p.push(i[n][0]),i[n]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(e[a]=l[a]);for(c&&c(t);p.length;)p.shift()();return r.push.apply(r,d||[]),s()}function s(){for(var e,t=0;t<r.length;t++){for(var s=r[t],a=!0,o=1;o<s.length;o++){var l=s[o];0!==i[l]&&(a=!1)}a&&(r.splice(t--,1),e=n(n.s=s[0]))}return e}var a={},i={1:0},r=[];function n(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=e,n.c=a,n.d=function(e,t,s){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(s,a,function(t){return e[t]}.bind(null,a));return s},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/";var o=window.webpackJsonp=window.webpackJsonp||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=l;r.push([14,0,2]),s()}({14:function(e,t,s){e.exports=s(40)},40:function(e,t,s){"use strict";s.r(t);s(15);var a=s(0);var i=[function(e,t,s){return".center"+t+"{text-align:center}.link"+t+"{border:none;padding:10px;border-radius:5px;text-decoration:none;background-color:#ff6000;color:#fff;margin-left:33%;margin-right:33%;display:inline-block;margin-top:1em}.info"+t+"{color:#000;background-color:#e4f2f8;margin:auto;padding:15px 10px;text-align:left;width:300px;border-radius:5px}.code"+t+"{font-family:monospace;font-size:large}.container"+t+"{margin-top:30px}img"+t+"{max-width:150px}.greeting"+t+"{height:75px}"}];var r=[function(e,t,s){return(s?":host{font-family:Ropa Sans,sans-serif;color:#333;max-width:640px;margin:0 auto;position:relative}":e+"{font-family:Ropa Sans,sans-serif;color:#333;max-width:640px;margin:0 auto;position:relative}")+".loadingMessage"+t+"{text-align:center;padding:40px;background-color:#eee}.canvas"+t+"{width:100%}"}];function n(e,t,s,a){const{h:i,t:r}=e;return[i("div",{classMap:{"slds-grid":!0,"slds-wrap":!0,"slds-grid_align-center":!0},key:5},[i("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_2-of-12":!0,"slds-large-size_3-of-12":!0},key:0},[]),i("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_8-of-12":!0,"slds-large-size_6-of-12":!0},key:3},[i("div",{classMap:{loadingMessage:!0},attrs:{"data-id":"loadingMessage"},key:1},[r("ðŸŽ¥ Unable to access video stream (please make sure you have a webcam enabled)")]),i("canvas",{classMap:{canvas:!0},attrs:{"data-id":"canvas"},props:{hidden:!0},key:2},[])]),i("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_2-of-12":!0,"slds-large-size_3-of-12":!0},key:4},[])])]}var o=Object(a.registerTemplate)(n);n.stylesheets=[],r&&n.stylesheets.push.apply(n.stylesheets,r),n.stylesheetTokens={hostAttribute:"my-qrCodeScanner-_qrCodeScanner-host",shadowAttribute:"my-qrCodeScanner-_qrCodeScanner"};var l=s(12),d=s.n(l);class c extends a.LightningElement{constructor(...e){super(...e),this._ui=null,this._isVisible=!1}get isVisible(){return this._isVisible}set isVisible(e){this._isVisible=e,this._isVisible?this._startVideo():this._stopVideo()}renderedCallback(){this._ui||(this._ui={},this._ui.video=document.createElement("video"),this._ui.canvasElement=this.template.querySelector("[data-id=canvas]"),this._ui.canvas=this._ui.canvasElement.getContext("2d"),this._ui.loadingMessage=this.template.querySelector("[data-id=loadingMessage]"),this._ui.loadingMessage.innerText="âŒ› Loading video...")}_tick(){if(this.isVisible){if(this._ui.video.readyState===this._ui.video.HAVE_ENOUGH_DATA)try{this._ui.loadingMessage.hidden=!0,this._ui.canvasElement.hidden=!1,this._ui.canvasElement.height=this._ui.video.videoHeight,this._ui.canvasElement.width=this._ui.video.videoWidth,this._ui.canvas.drawImage(this._ui.video,0,0,this._ui.canvasElement.width,this._ui.canvasElement.height);let e=this._ui.canvas.getImageData(0,0,this._ui.canvasElement.width,this._ui.canvasElement.height),t=d()(e.data,e.width,e.height,{inversionAttempts:"dontInvert"});if(t)try{this._drawBox(t),this.dispatchEvent(new CustomEvent("scanned",{detail:t.data}))}catch(e){console.log(t.data),console.error(e)}}catch(e){console.log(e)}else this._ui.loadingMessage.hidden=!1,this._ui.canvasElement.hidden=!0;window.requestAnimationFrame(()=>{this._tick()})}}_drawBox(e){this._drawLine(e.location.topLeftCorner,e.location.topRightCorner),this._drawLine(e.location.topRightCorner,e.location.bottomRightCorner),this._drawLine(e.location.bottomRightCorner,e.location.bottomLeftCorner),this._drawLine(e.location.bottomLeftCorner,e.location.topLeftCorner)}_drawLine(e,t){this._ui.canvas.beginPath(),this._ui.canvas.moveTo(e.x,e.y),this._ui.canvas.lineTo(t.x,t.y),this._ui.canvas.lineWidth=4,this._ui.canvas.strokeStyle="#FF3B58",this._ui.canvas.stroke()}_stopVideo(){this._ui&&this._ui.video&&this._ui.video.srcObject&&this._ui.video.srcObject.getVideoTracks().forEach(e=>e.stop())}_startVideo(){navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(e=>{this._ui.video.srcObject=e,this._ui.video.setAttribute("playsinline",!0),this._ui.video.play(),window.requestAnimationFrame(()=>{this._tick()})}).catch(()=>{alert("Your browser does not support camera, sorry. (1)")}):alert("Your browser does not support camera, sorry. (2)")}}Object(a.registerDecorators)(c,{publicProps:{isVisible:{config:3}},fields:["_ui","_isVisible"]});var h=Object(a.registerComponent)(c,{tmpl:o}),p=s(4),u=s.n(p);function g(e,t,s,a){const{h:i,d:r}=e;return[i("div",{classMap:{"slds-grid":!0,"slds-wrap":!0,"slds-grid_align-center":!0},key:7},[i("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_2-of-12":!0,"slds-large-size_3-of-12":!0},key:0},[]),i("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_8-of-12":!0,"slds-large-size_6-of-12":!0},key:5},[i("div",{classMap:{"slds-align_absolute-center":!0},key:2},[i("pre",{key:1},[r(t._qrDataIn)])]),i("div",{classMap:{"slds-align_absolute-center":!0},key:4},[i("pre",{key:3},[r(t._qrDataOut)])])]),i("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-medium-size_2-of-12":!0,"slds-large-size_3-of-12":!0},key:6},[])])]}var _=Object(a.registerTemplate)(g);g.stylesheets=[],u.a&&g.stylesheets.push.apply(g.stylesheets,u.a),g.stylesheetTokens={hostAttribute:"my-qrCodeData-_qrCodeData-host",shadowAttribute:"my-qrCodeData-_qrCodeData"};class m extends a.LightningElement{constructor(...e){super(...e),this._qrDataIn=null,this._qrDataOut=null,this.isVisible=!1}get qrData(){return this._qrDataIn}set qrData(e){console.log(e),this._qrDataIn=e,this._reportQRCode(e)}_reportQRCode(e){return new Promise((t,s)=>{try{const a=JSON.parse(e);if(this._qrDataIn=JSON.stringify(a,null,2),a.copy1===a.copy2){fetch("/reportQRCode",{method:"post",headers:{"Content-Type":"application/json"},body:e}).then(e=>e.text()).then(e=>{let s=JSON.parse(e);this._qrDataOut=JSON.stringify(s,null,2),t(s)}).catch(e=>s(e))}}catch(e){console.error(e)}})}}Object(a.registerDecorators)(m,{publicProps:{isVisible:{config:0},qrData:{config:3}},track:{_qrDataIn:1,_qrDataOut:1}});var b=Object(a.registerComponent)(m,{tmpl:_});function y(e,t,s,a){const{h:i}=e;return[i("div",{classMap:{"slds-grid":!0,"slds-wrap":!0,"slds-grid_align-center":!0},styleMap:{height:"100%"},key:2},[i("div",{classMap:{"slds-col":!0,"slds-size_1-of-1":!0,"slds-align_absolute-center":!0},key:1},[i("canvas",{attrs:{"data-id":"QRCode"},key:0},[])])])]}var f=Object(a.registerTemplate)(y);y.stylesheets=[],u.a&&y.stylesheets.push.apply(y.stylesheets,u.a),y.stylesheetTokens={hostAttribute:"my-qrCodeGenerator-_qrCodeGenerator-host",shadowAttribute:"my-qrCodeGenerator-_qrCodeGenerator"};var v=s(13),w=s.n(v);class k extends a.LightningElement{constructor(){super(),this.isVisible=!1,setInterval(()=>{this.isVisible&&this.generateQR()},1e3)}generateQR(){const e=this.template.querySelector('[data-id="QRCode"]'),t=JSON.stringify((new Date).getMilliseconds());w.a.toCanvas(e,t,{margin:0,width:.9*Math.min(window.innerWidth,window.innerHeight)}).then(()=>{console.log("Generated QR!")}).catch(e=>{throw Error(e)})}}Object(a.registerDecorators)(k,{publicProps:{isVisible:{config:0}}});var q=Object(a.registerComponent)(k,{tmpl:f});function D(e,t,s,a){const{t:i,b:r,h:n,c:o}=e,{_m0:l,_m1:d,_m2:c,_m3:p}=a;return[n("div",{classMap:{"slds-tabs_default":!0,"slds-tabs_large":!0},key:10},[n("ul",{classMap:{"slds-tabs_default__nav":!0},key:3},[n("li",{classMap:{"slds-tabs_default__item":!0},attrs:{"data-id":"tabScanner"},key:0,on:{click:l||(a._m0=r(t.showScanner))}},[i("Scanner")]),n("li",{classMap:{"slds-tabs_default__item":!0},attrs:{"data-id":"tabData"},props:{hidden:!0},key:1,on:{click:d||(a._m1=r(t.showData))}},[i("Data")]),n("li",{classMap:{"slds-tabs_default__item":!0},attrs:{"data-id":"tabGenerator"},key:2,on:{click:c||(a._m2=r(t.showGenerator))}},[i("Generator")])]),n("div",{classMap:{"slds-tabs_default__content":!0},attrs:{"data-id":"pageScanner"},props:{hidden:!0},key:5},[o("my-qr-code-scanner",h,{props:{isVisible:t.pageVisibility.scanner},key:4,on:{scanned:p||(a._m3=r(t.handleDataScanned))}},[])]),n("div",{classMap:{"slds-tabs_default__content":!0},attrs:{"data-id":"pageData"},props:{hidden:!0},key:7},[o("my-qr-code-data",b,{props:{qrData:t.qrData},key:6},[])]),n("div",{classMap:{"slds-tabs_default__content":!0},attrs:{"data-id":"pageGenerator"},props:{hidden:!0},key:9},[o("my-qr-code-generator",q,{props:{isVisible:t.pageVisibility.generator},key:8},[])])]),i("v2.2")]}var M=Object(a.registerTemplate)(D);D.stylesheets=[],i&&D.stylesheets.push.apply(D.stylesheets,i),D.stylesheetTokens={hostAttribute:"my-app-_app-host",shadowAttribute:"my-app-_app"};class O extends a.LightningElement{constructor(){super(),this._initialized=!1,this.qrData=null,this.pageVisibility={},this.pageVisibility={data:!1,scanner:!1,generator:!1}}renderedCallback(){if(!this._initialized){this._initialized=!0;let e=new URLSearchParams(window.location.search);switch(e.get("tab")){case"scanner":case"generator":this._switchPage(e.get("tab"));break;default:this._switchPage("scanner")}}}handleDataScanned(e){const t=e.detail;this.qrData=t,this._switchPage("data")}showScanner(){this._switchPage("scanner")}showData(){this._switchPage("data")}showGenerator(){this._switchPage("generator")}_getDOM(){return{tabs:{scanner:this.template.querySelector('[data-id="tabScanner"]'),data:this.template.querySelector('[data-id="tabData"]'),generator:this.template.querySelector('[data-id="tabGenerator"]')},pages:{scanner:this.template.querySelector('[data-id="pageScanner"]'),data:this.template.querySelector('[data-id="pageData"]'),generator:this.template.querySelector('[data-id="pageGenerator"]')}}}_switchPage(e){let t=this._getDOM();Object.keys(this.pageVisibility).forEach(t=>{this.pageVisibility[t]=t===e}),Object.keys(t.tabs).forEach(s=>{s===e?(t.tabs[s].hidden=!1,t.tabs[s].classList.add("slds-is-active")):t.tabs[s].classList.remove("slds-is-active"),t.pages[s].hidden=s!==e}),"scanner"===e&&(t.tabs.data.hidden=!0,t.pages.data.hidden=!0)}}Object(a.registerDecorators)(O,{track:{qrData:1,pageVisibility:1},fields:["_initialized"]});var C=Object(a.registerComponent)(O,{tmpl:M});customElements.define("my-app",Object(a.buildCustomElementConstructor)(C))}});